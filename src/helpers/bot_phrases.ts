import { cities } from './cities.js';
import { Collection, Task, User } from './database.js';
import { formatTimestamp } from './utils.js';

export const phrases = {
  main: `–û—Ç–∫—Ä–æ–π—Ç–µ –º–∏—Ä –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–µ–π —Å –Ω–∞–º–∏ ‚Äî –º—ã –∞–Ω–∞–ª–∏–∑–∏—Ä—É–µ–º –≤—Å–µ –Ω–æ–≤—ã–µ –æ–±—ä—è–≤–ª–µ–Ω–∏—è –ê–≤–∏—Ç–æ, —á—Ç–æ –µ—Å—Ç—å –≤ –†–æ—Å—Å–∏–∏, –ø—Ä–µ–≤—Ä–∞—â–∞—è –∏—Ö –≤ —Ü–µ–Ω–Ω—ã–µ –∑–Ω–∞–Ω–∏—è –¥–ª—è —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–æ–≤ –∏ –ø–æ–∏—Å–∫–∞.\n\n<strong>–í—ã–±–µ—Ä–∏—Ç–µ –Ω—É–∂–Ω–æ–µ –¥–µ–π—Å—Ç–≤–∏–µ:</strong>`,
  search_main: `<strong>–ì–ª–∞–≤–Ω–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞ –æ–±—ä—è–≤–ª–µ–Ω–∏–π</strong>\n\n–í—ã–±–µ—Ä–µ—Ç–µ –ø—É–Ω–∫—Ç –º–µ–Ω—é:`,

  search_start_stop_main: (cond: string) =>
    `<strong>–î–æ—Å—Ç—É–ø–Ω—ã–µ –æ–±—ä—è–≤–ª–µ–Ω–∏—è –¥–ª—è –ø–æ–∏—Å–∫–∞</strong>\n\n–í—ã–±–µ—Ä–µ—Ç–µ –Ω—É–∂–Ω–æ–µ –∑–∞–¥–∞–Ω–∏–µ –¥–ª—è ${cond === 'START' ? '—Å—Ç–∞—Ä—Ç–∞' : '–ø–∞—É–∑—ã'}:`,

  search_start_stop_main_error: (cond: string) =>
    `<strong>–î–æ—Å—Ç—É–ø–Ω—ã–µ –æ–±—ä—è–≤–ª–µ–Ω–∏—è –¥–ª—è –ø–æ–∏—Å–∫–∞</strong>\n\n‚ö†Ô∏è –ù–µ—Ç –∑–∞–¥–∞–Ω–∏–π –¥–ª—è ${cond === 'START' ? '—Å—Ç–∞—Ä—Ç–∞' : '–ø–∞—É–∑—ã'}:`,

  tasks_edit_main: `<strong>–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ–∏—Å–∫–∞ –æ–±—ä—è–≤–ª–µ–Ω–∏–π</strong>\n\n–í—ã–±–µ—Ä–µ—Ç–µ –Ω—É–∂–Ω–æ–µ –∑–∞–¥–∞–Ω–∏–µ:`,
  task_edit: `‚¨áÔ∏è <strong>–ü—Ä–∏–º–µ—Ä—ã –∫–æ–º–∞–Ω–¥ –¥–ª—è –≤–≤–æ–¥–∞:</strong>
  ‚îú –ù–∞–∑–≤–∞–Ω–∏–µ –æ–±—ä—è–≤–ª–µ–Ω–∏—è: iphone 16 pro max 256gb
  ‚îú –ì–æ—Ä–æ–¥: –ú–æ—Å–∫–≤–∞ –∏ –ú–û
  ‚îú –ê–≤–∏—Ç–æ –¥–æ—Å—Ç–∞–≤–∫–∞: –¥–∞
  ‚îú –¶–µ–Ω–∞ –æ—Ç: 75000
  ‚îî –¶–µ–Ω–∞ –¥–æ: 150000

–î–ª—è –ø–æ–∏—Å–∫–∞ –ø–æ –ú–æ—Å–∫–≤–µ –∏ –ú–û, –≤–≤–µ–¥–∏—Ç–µ - –ú–æ—Å–∫–≤–∞ –∏ –ú–û, –ø–æ –°–∞–Ω–∫—Ç-–ü–µ—Ç–µ—Ä–±—É—Ä–≥—É –∏ –õ–û - –°–∞–Ω–∫—Ç-–ü–µ—Ç–µ—Ä–±—É—Ä–≥ –∏ –õ–û, –≤—Å–µ —Ä–µ–≥–∏–æ–Ω—ã - –†–æ—Å—Å–∏—è.

<strong>–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤–≤–µ–¥–∏—Ç–µ –Ω–∞–∑–≤–∞–Ω–∏–µ –æ–±—ä—è–≤–ª–µ–Ω–∏—è:</strong>\n`,

  steps: [
    '–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤–≤–µ–¥–∏—Ç–µ –≥–æ—Ä–æ–¥:',
    '–° –∞–≤–∏—Ç–æ –¥–æ—Å—Ç–∞–≤–∫–æ–π?',
    '–¶–µ–Ω–∞ –æ—Ç:',
    '–¶–µ–Ω–∞ –¥–æ:',
  ],

  support_main: `‚úÖ <strong>–ß–∞—Ç —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω</strong>\n
–ü–µ—Ä–µ—Ö–æ–¥–∏—Ç–µ —Å—Ä–∞–∑—É <strong>–∫ —Å—É—Ç–∏ –¥–µ–ª–∞ –≤ –æ–±—Ä–∞—â–µ–Ω–∏–∏ –∑–∞ –ø–æ–º–æ—â—å—é,</strong> —Å—Ç–∞—Ä–∞—è—Å—å –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ –æ—Å–≤–µ—Ç–∏—Ç—å –ø—Ä–æ–±–ª–µ–º—É. 
–¢–∞–∫–∏–º –æ–±—Ä–∞–∑–æ–º –º—ã —Å–º–æ–∂–µ–º –±—ã—Å—Ç—Ä–æ –¥–∞—Ç—å –æ—Ç–≤–µ—Ç –∏ —Ä–µ—à–∏—Ç—å –í–∞—à—É –ø—Ä–æ–±–ª–µ–º—É. –ú—ã –ø–æ—Å—Ç–∞—Ä–∞–µ–º—Å—è –ø–æ–º–æ—á—å –∫–∞–∫ –º–æ–∂–Ω–æ –±—ã—Å—Ç—Ä–µ–µ, –Ω–æ –æ–∂–∏–¥–∞–Ω–∏–µ –º–æ–∂–µ—Ç –∑–∞–Ω—è—Ç—å –≤—Ä–µ–º—è.

<strong>–ì—Ä–∞—Ñ–∏–∫ —Ä–∞–±–æ—Ç—ã:</strong> 09:00-23:00 –ø–æ –ú–æ—Å–∫–≤–µ.

<strong>–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –Ω–∞–ø–∏—à–∏—Ç–µ –≤–∞—à—É –ø—Ä–æ–±–ª–µ–º—É:</strong>`,

  support_end: `<strong>üí¨ –í—ã –ø–æ–∫–∏–Ω—É–ª–∏ —á–∞—Ç —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π</strong>`,
  support_messege_send: `<strong>–í–∞—à–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ</strong>. 
–ú—ã –ø–æ—Å—Ç–∞—Ä–∞–µ–º—Å—è –æ—Ç–≤–µ—Ç–∏—Ç—å –∫–∞–∫ –º–æ–∂–Ω–æ —Å–∫–æ—Ä–µ–µ.`,
  support_messege_error: `<strong>–í–∞—à–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –Ω–µ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ</strong>. 
–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –¥–æ–∂–¥–∏—Ç–µ—Å—å –æ—Ç–≤–µ—Ç–∞ –Ω–∞ –æ–±—Ä–∞—â–µ–Ω–∏–µ.`,

  success: 'üòé –£—Å–ø–µ—Ö!',
  error: `<strong>‚ö†Ô∏è –û—à–∏–±–∫–∞!</strong>
  –ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –ø–æ–≤—Ç–æ—Ä–∏—Ç–µ –∑–Ω–∞—á–µ–Ω–∏–µ`,

  admin_main: '–ì–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é –ê–¥–º–∏–Ω–∞',

  account_main: (user: User): string => `<strong>–ú–æ–π –∞–∫–∫–∞—É–Ω—Ç</strong>
<em>–í—Å—è –Ω–µ–æ–±—Ö–æ–¥–∏–º–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –≤–∞—à–µ–º –ø—Ä–æ—Ñ–∏–ª–µ</em>
  <strong>
üëÅ‚Äçüó® ID: <code>${user.id}</code>
üëÅ‚Äçüó® –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è: <code>${formatTimestamp(user.created_at, false)}</code>

üí∂ –ú–æ–π –∫–æ—à–µ–ª—ë–∫: <code>${Number(user.balance)}‚ÇΩ</code>
üíé –ü–æ–¥–ø–∏—Å–∫–∞ –¥–æ: <code>${user.subscribtionTo < Math.floor(Date.now() / 1000) ? '–æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç' : formatTimestamp(user.subscribtionTo, true)}</code>
–õ–∏–º–∏—Ç –∑–∞–ø—Ä–æ—Å–æ–≤ –≤ —Å—É—Ç–∫–∏:

${showAllTasks(user.tasks)}</strong>`,

  subscribrion_main: `<strong>–ü–æ–¥–ø–∏—Å–∫–∞</strong> ‚Äî –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç –±–µ–∑–ª–∏–º–∏—Ç–Ω—ã–π –¥–æ—Å—Ç—É–ø –∫ –Ω–∞–π–¥–µ–Ω–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏, —É–≤–µ–ª–∏—á–∏–≤–∞–µ—Ç –ª–∏–º–∏—Ç –ø–æ–∏—Å–∫–æ–≤—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤ –¥–æ 3.`,
  subscribtion_success: `<strong>üòé –£—Å–ø–µ—Ö!</strong>
  –ü–æ–¥–ø–∏—Å–∫–∞ –±—ã–ª–∞ —É—Å–ø–µ—à–Ω–æ –æ—Ñ–æ—Ä–º–ª–µ–Ω–∞.`,

  promo_main: `<strong>–ê–∫—Ç–∏–≤–∏—Ä–æ–≤–∞—Ç—å –∫—É–ø–æ–Ω</strong>
–£ –≤–∞—Å –µ—Å—Ç—å –∫–æ–¥ –∫—É–ø–æ–Ω–∞ ?

–í–≤–µ–¥–∏—Ç–µ –∫–æ–¥ –∫—É–ø–æ–Ω–∞:`,

  edit_sub_error: (
    user: User,
    price: number,
  ): string => `<strong>üõë –ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ —Å—Ä–µ–¥—Å—Ç–≤ –¥–ª—è –æ–ø–ª–∞—Ç—ã.</strong>

<strong>–í –¥–∞–Ω–Ω—ã–π –º–æ–º–µ–Ω—Ç –≤–∞—à –±–∞–ª–∞–Ω—Å:</strong> <code>${user.balance}‚ÇΩ</code>
<strong>–ù–µ–æ–±—Ö–æ–¥–∏–º–æ: </strong> <code>${price}‚ÇΩ</code>

–ü–æ–ø–æ–ª–Ω–∏—Ç–µ –±–∞–ª–∞–Ω—Å –∏ –ø–æ–≤—Ç–æ—Ä–∏—Ç–µ –ø–æ–ø—ã—Ç–∫—É.`,

  up_balance_main: `<strong>–í–≤–µ–¥–∏—Ç–µ —Å—É–º–º—É –Ω–∞ –∫–æ—Ç–æ—Ä—É—é —Ö–æ—Ç–∏—Ç–µ –ø–æ–ø–æ–ª–Ω–∏—Ç—å –í–∞—à –±–∞–ª–∞–Ω—Å –∏–ª–∏ –≤—ã–±–µ—Ä–µ—Ç–µ –∏–∑ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–Ω—ã—Ö:</strong>`,

  init_pay: `<strong>üí≥ –î–ª—è –ø–æ–ø–æ–ª–Ω–µ–Ω–∏—è –±–∞–ª–∞–Ω—Å–∞ –Ω–∞–∂–º–∏—Ç–µ –∫–Ω–æ–ø–∫—É –Ω–∏–∂–µ:</strong>`,
};

function getCityKey(value: string): string | undefined {
  const formattedValue = value.replace(/_/g, ' ');
  const entry = Object.entries(cities).find(
    ([_key, val]) => val === formattedValue,
  );
  return entry ? entry[0] : undefined;
}

function showAllTasks(tasks: Collection<Task>): string[] {
  const textArray = [];
  if (!tasks) {
    return [];
  }
  const taskArray = Object.values(tasks);
  for (const t of taskArray) {
    let text = `üîé –ú–æ–µ —Ç–µ–∫—É—â–µ–µ –∑–∞–¥–∞–Ω–∏–µ ${t.id}:
‚îú –ù–∞–∑–≤–∞–Ω–∏–µ –æ–±—ä—è–≤–ª–µ–Ω–∏—è: <code>${t.query.replace(/\+/g, ' ')}</code>
‚îú –ì–æ—Ä–æ–¥: <code>${getCityKey(t.city)}</code>
‚îú –ê–≤–∏—Ç–æ –¥–æ—Å—Ç–∞–≤–∫–∞: <code>${t.dostavka ? '–¥–∞' : '–Ω–µ—Ç'}</code>
‚îú –¶–µ–Ω–∞ –æ—Ç: <code>${t.price_From}</code>
‚îú –¶–µ–Ω–∞ –¥–æ: <code>${t.price_To}</code>
‚îî –°—Ç–∞—Ç—É—Å: <code>${t.is_Active ? '—Ä–∞–±–æ—Ç–∞–µ—Ç' : '–æ—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω'}</code>\n
`;
    textArray.push(text);
  }
  return textArray;
}
